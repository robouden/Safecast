<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project basedir=".." default="all" name="Create Runnable Jar for Project DriveQa with Jar-in-Jar Loader">

	<property name="app.version" value="0.2.2b by rob (rob@yr-design.biz)"/>
	<tstamp>
	  <format property="app.dstamp" pattern="yyyy-MM-dd"/>
	</tstamp>
	
	<property name="build" location="bin"/>
	<property name="src" location="src"/>
	
	<target name="all" depends="buildinfo,compile,create_run_jar,html"/>

	<target name="buildinfo">
		<propertyfile file="release/build.properties"
	        comment="This file is automatically generated - DO NOT EDIT">        
	        <entry key="version" value="${app.version}"/>
			<entry key="data" value="${app.dstamp}}"/>
	    </propertyfile>
	</target>

	<path id="lib-classpath">
	  <fileset dir="jar">
	    <include name="*.jar"/>
	  </fileset>
	  <pathelement path="${build.dir}"/>
	</path>
	
	<target name="compile">
	    <mkdir dir="${build}"/>
	    <javac destdir="${build}" includeantruntime="false">
	    	<src path="${src}"/>
			<classpath refid="lib-classpath"/>
	    </javac>
	</target>
	
	<!--this target was created by Eclipse Runnable JAR Export Wizard-->
    <!--ANT 1.7 is required                                        -->
    <target name="create_run_jar">
        <jar destfile="release/DriveQA-120401.jar">
            <manifest>
                <attribute name="Main-Class" value="org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader"/>
                <attribute name="Rsrc-Main-Class" value="org.safecast.ui.qa.QaGui"/>
                <attribute name="Class-Path" value="."/>
                <attribute name="Rsrc-Class-Path" value="./ sqlitejdbc-v056.jar jfreechart-1.0.13.jar jcommon-1.0.16.jar"/>
            </manifest>
            <zipfileset src="build/jar-in-jar-loader.zip"/>
            <fileset dir="${build}"/>
            <zipfileset dir="jar" includes="sqlitejdbc-v056.jar"/>
            <zipfileset dir="jar" includes="jfreechart-1.0.13.jar"/>
            <zipfileset dir="jar" includes="jcommon-1.0.16.jar"/>
        	<fileset dir="release" includes="build.properties"/>
        	<fileset dir="l10n" includes="*.properties"/>
        </jar>
    </target>
	
	<!--Build an HTML file with release information. -->
	<target name="html">
		<copy file="build/index.html" todir="release" overwrite="true"/>
		<replace dir="release" token="$release_date" value="${app.dstamp}" encoding="utf-8">
		  <include name="index.html"/>
		</replace>
		<replace dir="release" token="$release_version" value="${app.version}" encoding="utf-8">
		  <include name="index.html"/>
		</replace>
	</target>
		
</project>
